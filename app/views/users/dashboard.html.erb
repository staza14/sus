<div class ="container">
<div class="d-flex user-dashboard-content" >
  <div class="sticky-side col-3">
    <%# USER CARD BEGINS %>
    <div class="user-info-div">
      <div class="big-div">
        <div class="user-info-child" id="floating-avatar">
          <%= image_tag 'flower.png' %>
        </div>
        <div class="user-info-child" id="user-name">
          <h5><%= current_user.first_name.upcase + ' ' + current_user.last_name.upcase %></h5>
        </div>
        <div class="user-info-child" id="user-friend-info">
          <div class="user-friend-info-child" id="followers">
            <h6>Friends</h6>
            <h4>4</h4>
            <%# <h5><%= current_user.friendships </h5> %>
          </div>
          <div class="user-friend-info-child" id="following">
            <h6>Challenges</h6>
            <h4>7</h4>
            <%# <h5><%= current_user.completed_challenges </h5> %>
          </div>
          <div class="user-friend-info-child" id="posts">
            <h6>Posts</h6>
            <h4>11</h4>
            <%# <h5><%= current_user.posts.count </h5> %>
          </div>
        </div>
      </div>
    </div>
    <%# USER CARD END %>
    <button type="button" class="call-to-action" id="add-entry" data-bs-toggle="modal" data-bs-target="#exampleModal">ADD ENTRY</button>
    <div class="daily-facts"></div>
  </div>
  <div class="my-challenges col-9">
    <h1>Your progress</h1>
    <div class="container">
      <%= line_chart [
        {name: "Food Score", data: @food_data, color: "#ED936D"},
        {name: "Travel Score", data: @travel_data, color: "#2A6465"},
        {name: "Home Score", data: @home_data, color: "#97C5DE"}
        ] %>
    </div>
    <div class="active-challenges">
      <h3> Your active challenges</h3>
      <div class="challenge-iteration" id="active-challenge">
        <% @active_challenges.each do |challenge| %>
        <div class="dashboard-challenges">
          <h3> <%=challenge.challenge.name %></h3>
          <h5><%= challenge.challenge.summary %></h5>
<%# <button type="button" class="add-button" data-bs-toggle="modal" data-bs-target="#exampleModal<%= challenge.challenge.id "> %>
  <%# <i class="fa-solid fa-pen fa-xl"></i> %>
<%# </button> %>
          <!-- Modal -->
          <div class="modal fade" id="exampleModal<%= challenge.challenge.id %>" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="exampleModalLabel"><%=challenge.challenge.name  %></h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <h4><%= challenge.challenge.prompt %></h4>
                  <div  class="wrapper d-flex">
                    <% challenge.active_challenge_days.each do |day| %>
                    <%= simple_form_for [challenge, day], html: {data: {controller: "mark-as-complete", action: "submit->mark-as-complete#update"}} do |f| %>
                    <%= f.input :status , as: :boolean , input_html: {checked: true}, wrapper_html: {class: "d-none"} %>
                    <%= f.submit day.day, data: {mark_as_complete_target: "submit"}, class:"p-2 mx-2 rounded-4" %>
                    <% end  %>
                    <% end %>
                  </div>
                  <%= button_to "save", challenges_path, class:"call-to-action mt-3" %>
                </div>
              </div>
            </div>
          </div>
          <div class="wrapper d-flex">
            <% challenge.active_challenge_days.each do |day| %>
            <div class="circle <%= day.status ? "green" : "grey" %>">
              <h5 class="p-2"><%= day.day %></h5>
            </div>
            <% end %>
          </div>
        </div>
        <%end%>
      </div>
    </div>
    <div class="completed-challenges">
      <h3> Your completed challenges</h3>
      <div class="challenge-iteration" id="completed-challenges">
          <% @completed_challenges.each do |challenge| %>
          <div class="dashboard-challenges">
            <h3> <%=challenge.challenge.name %></h3>
            <h5><%= challenge.challenge.summary %></h5>
            <h5><%= challenge.challenge.duration %> days</h5>
          </div>
          <%end %>
      </div>
    </div>
  </div>
</div>
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Daily Log</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <%= simple_form_for @entry do |f| %>
        <%= f.input :car_hours, label: "How many hours did you travel by car today?", input_html: {value: 0} %>
        <%= f.input :bus_hours, label: "How many hours did you travel by bus today?", input_html: {value: 0} %>
        <%= f.input :train_hours, label: "How many hours did you travel by train today?", input_html: {value: 0} %>
        <%= f.input :cycle_hours, label: "How many hours did you travel by cycle today?", input_html: {value: 0} %>
        <%= f.input :foot_hours, label: "How many hours did you walk today?", input_html: {value: 0} %>
        <%= f.input :beef, as: :range, prompt: "my data", collection: 0..3,
          label: "How many of your meals contained beef today?",
          input_html: { class: "form-range", value: 0, min:"0", max:"3", step:"1", oninput:"updateTextInput1(this.value)" }
          %>
        <input type="text" id="textInput1" value="" style= "border:none; background-color: #F4F4F4;">
        <%= f.input :lamb, as: :range, prompt: "my data", collection: 0..3,
          label: "How many of your meals contained lamb today?",
          input_html: { class: "form-range", value: 0, min:"0", max:"3", step:"1", oninput:"updateTextInput2(this.value)"}

            %>
        <input type="text" id="textInput2" value="" style= "border:none; background-color: #F4F4F4;">
        <%= f.input :cheese, as: :range, prompt: "my data", collection: 0..3,
          label: "How many of your meals contained cheese today?",
          input_html: { class: "form-range", value: 0, min:"0", max:"3", step:"1", oninput:"updateTextInput3(this.value)"}

            %>
        <input type="text" id="textInput3" value="" style= "border:none; background-color: #F4F4F4;">
        <%= f.input :pork, as: :range, prompt: "my data", collection: 0..3,
          label: "How many of your meals contained pork today?",
          input_html: { class: "form-range", value: 0, min:"0", max:"3", step:"1", oninput:"updateTextInput4(this.value)"}

            %>
        <input type="text" id="textInput4" value="" style= "border:none; background-color: #F4F4F4;">
        <%= f.input :chocolate, as: :range, prompt: "my data", collection: 0..3,
          label: "How many of your meals contained chocolate today?",
          input_html: { class: "form-range", value: 0, min:"0", max:"3", step:"1", oninput:"updateTextInput5(this.value)"}

            %>
        <input type="text" id="textInput5" value="" style= "border:none; background-color: #F4F4F4;">
        <%= f.input :fish, as: :range, prompt: "my data", collection: 0..3,
          label: "How many of your meals contained fish today?",
          input_html: { class: "form-range", value: 0, min:"0", max:"3", step:"1", oninput:"updateTextInput6(this.value)"}

            %>
        <input type="text" id="textInput6" value="" style= "border:none; background-color: #F4F4F4;">
        <%= f.input :egg, as: :range, prompt: "my data", collection: 0..3,
          label: "How many of your meals contained egg today?",
          input_html: { class: "form-range", value: 0, min:"0", max:"3", step:"1", oninput:"updateTextInput7(this.value)"}

            %>
        <input type="text" id="textInput7" value="" style= "border:none; background-color: #F4F4F4;">
        <%= f.input :bath, as: :select, collection: ["Yes", "No"],
          label: "Today, I took a bath"
          %>
        <%= f.input :long_shower, as: :select, collection: ["Yes", "No"],
          label: "Today, I took a long shower (more than 10mins)?"
          %>
        <%= f.input :short_shower, as: :select, collection: ["Yes", "No"],
          label: "Today, I took a quick shower (less than 10mins)?"
          %>
        <div class="modal-footer">
          <%= f.submit   %>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  function updateTextInput2(val) {
            document.getElementById('textInput2').value=val;
          }
  function updateTextInput1(val) {
            document.getElementById('textInput1').value=val;
          }
  function updateTextInput3(val) {
            document.getElementById('textInput3').value=val;
          }
  function updateTextInput4(val) {
            document.getElementById('textInput4').value=val;
          }
  function updateTextInput5(val) {
            document.getElementById('textInput5').value=val;
          }
  function updateTextInput6(val) {
            document.getElementById('textInput6').value=val;
          }
  function updateTextInput7(val) {
            document.getElementById('textInput7').value=val;
          }
</script>


<div class= "container">

  <div class="row justify-content-center" >
    <div class="col-sm-8 my-3">

      <%= form_with url: feed_path, method: :get, class: "d-flex", html: {data: {action: "submit->user-card#revealContent"}} do |f| %>
        <%= f.text_field :query,
              value: params[:query],
              class: "form-control",

              placeholder: "Search by email for friends to follow",
              data: { user_card_target: "input" }
          %>
          <div data-user-card-target="button">
        <%= submit_tag "Search", name: "", class: "btn btn-primary" %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="d-flex mt-5">
    <div class="sticky-side">
      <div class="user-card mt-5 rounded-5">
        <% if current_user.avatar %>
          <%=  image_tag current_user.avatar, class:"my-avatar"%>
        <% end %>
        <div>
          <div class="d-flex justify-content-center">
            <h1>Hi <%= current_user.first_name %></h1>
          </div>
          <div class="d-flex justify-content-center">
            <div class="stats">
            <p class ="mb-0"><%=current_user.friends.count%></p>
            <p class="small-text mt-0">friends</p>
            </div>
            <div class="stats">
            <p class="mb-0"><%= @completed.count  %></p>
            <p class="small-text mt-0"> completed challenges</p>
            </div>
            <div class="stats">
            <p class="mb-0"><%= current_user.overall_score  %></p>
            <p class="small-text mt-0"> sus score</p>
            </div>
          </div>


  <div class="row justify-content-center">
    <div class="col-sm-8">
      <div id="user" class="" data-user-card-target="cards">

          <div class=" sus-score-chart">
            <%= line_chart [
                {name: "sus score", data: @day_data, color: "#ED936D"},
              ] %>
          </div>
        </div>
      </div>
      <div class="container">
          <button type="button" class="call-to-action mt-5 px-5 py-3" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
            Add Post
          </button>
      </div>
    </div>


      <div class="right-side">
        <div class="leaderboard">
          <h2>Leaderboard</h2>
          <ol>
          <% @leaders.each do |leader| %>
            <li> <%= leader.first_name %> <%= leader.overall_score %></li>
          <%end  %>
          </ol>
          <h4> You are <%=@my_rank%>th in your friends</h4>
        </div>

        <div data-controller="user-card">


        <div class="row justify-content-center">
          <div class="col-sm-8">
            <div id="user" class="" data-user-card-target="cards">


            </div>
        </div>
        <div class="leaderboard">

        </div>

        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Post</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">
                <%= simple_form_for @post do |f| %>
                  <%= f.input :content %>
                  <%= f.input :image %>
                  <%= f.submit "Submit post", class: "btn btn-primary" %>
                <% end %>
              </div>
            </div>
          </div>
        </div>

      <div class="container">
          <% @all.reverse.each do |post| %>
          <div class="post-container">
            <div class="post-header">
              <div class='name-avatar'>
                <div class='post-name'>
                <%= post.user.first_name %> <%= post.user.last_name %>
              <br>
              posted <%= @today - (post.created_at.to_date.mjd) %> days ago
                </div>
              </div>
            </div>
            <div class='content-div'>
              <div class='post-content'>
                <%= post.content %>
              </div>
            </div>
          </div>
          <% end %>
      </div>
    </div>
  </div>
</div>
